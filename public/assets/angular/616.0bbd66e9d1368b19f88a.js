(self.webpackChunkangular=self.webpackChunkangular||[]).push([[616],{2616:(e,n,t)=>{"use strict";t.r(n),t.d(n,{TicketsModule:()=>U});var i=t(8583),o=t(4466),c=t(1841),s=t(665),l=t(3423),r=t(7278),a=t(2340),d=t(7716),g=t(6854),p=t(2323),u=t(3117),f=t(9936),h=t(8424),v=t(3451),x=t(8429),m=t(1425);function Z(e,n){if(1&e&&d._UZ(0,"nz-option",10),2&e){const e=n.$implicit;d.Q6J("nzLabel",e.title)("nzValue",e.id)}}function z(e,n){if(1&e){const e=d.EpF();d.TgZ(0,"div",7),d.TgZ(1,"nz-select",8),d.NdJ("ngModelChange",function(n){return d.CHM(e),d.oxw().selectedEvent=n})("ngModelChange",function(n){return d.CHM(e),d.oxw().onChangeEvent(n)}),d.YNc(2,Z,1,2,"nz-option",9),d.qZA(),d.qZA()}if(2&e){const e=d.oxw();d.xp6(1),d.Q6J("ngModel",e.selectedEvent)("nzLoading",e.loadingEvent),d.xp6(1),d.Q6J("ngForOf",e.events)}}function w(e,n){if(1&e){const e=d.EpF();d.TgZ(0,"div",11),d.TgZ(1,"i",12),d.NdJ("click",function(){return d.CHM(e),d.oxw().onDownload()}),d.qZA(),d.TgZ(2,"i",13),d.NdJ("click",function(){return d.CHM(e),d.oxw().onDownloadOrder()}),d.qZA(),d.qZA()}}function A(e,n){if(1&e&&(d.TgZ(0,"p",27),d._uU(1),d.qZA()),2&e){const e=d.oxw().$implicit;d.xp6(1),d.AsE("",e.name," ",e.lastname,"")}}function T(e,n){if(1&e&&(d.TgZ(0,"p",27),d._uU(1),d.qZA()),2&e){const e=d.oxw().$implicit;d.xp6(1),d.hij("S/ ",e.price,"")}}function k(e,n){1&e&&(d.TgZ(0,"div",28),d._uU(1," CONFIRMADO "),d.qZA())}const b=function(e){return["/validate-token",e]};function S(e,n){if(1&e&&(d.TgZ(0,"section",17),d.TgZ(1,"a",18),d.TgZ(2,"div",19),d.TgZ(3,"div",20),d._UZ(4,"img",21),d.qZA(),d.TgZ(5,"div",22),d.TgZ(6,"div",23),d.TgZ(7,"p"),d._uU(8),d.qZA(),d.TgZ(9,"h5",24),d._uU(10),d.qZA(),d.YNc(11,A,2,2,"p",25),d.YNc(12,T,2,1,"p",25),d.YNc(13,k,2,0,"div",26),d.qZA(),d.qZA(),d.qZA(),d.qZA(),d.qZA()),2&e){const e=n.$implicit,t=d.oxw(2);d.xp6(1),d.Q6J("routerLink",d.VKq(7,b,e.id)),d.xp6(3),d.Q6J("src",t.routeStorage+"/"+e.event_path,d.LSH),d.xp6(4),d.hij("N\xb0 ",e.ticket,""),d.xp6(2),d.Oqu(e.event_title),d.xp6(1),d.Q6J("ngIf",t.user.isadmin),d.xp6(1),d.Q6J("ngIf",!t.user.isadmin),d.xp6(1),d.Q6J("ngIf",1==e.confirm)}}function q(e,n){1&e&&(d.TgZ(0,"section",29),d.TgZ(1,"h2"),d._uU(2,"No tiene Tickets"),d.qZA(),d.qZA())}function E(e,n){if(1&e&&(d.TgZ(0,"div",14),d.YNc(1,S,14,9,"section",15),d.YNc(2,q,3,0,"section",16),d.qZA()),2&e){const e=d.oxw();d.xp6(1),d.Q6J("ngForOf",e.tickets),d.xp6(1),d.Q6J("ngIf",0==e.tickets.length)}}const J=[{path:"",component:(()=>{class e{constructor(e,n,t){this.orderService=e,this.storageService=n,this.eventService=t,this.tickets=[],this.routeStorage=a.N.storageUrl,this.loading=!0,this.loadingEvent=!0,this.events=[],this.user=this.storageService.getUser()}ngOnInit(){this.getAllEvent()}onChangeTab(e){console.log(),this.getAllTickets(e.index)}getAllTickets(e){this.loading=!0,this.orderService.getTickets(e).subscribe(e=>{this.loading=!1,this.tickets=e},e=>{this.loading=!1})}getAllEvent(){this.loadingEvent=!0,this.eventService.getFindAll().subscribe(e=>{var n;this.events=e,this.loadingEvent=!1,this.selectedEvent=this.events[0].id,(null===(n=this.user)||void 0===n?void 0:n.isadmin)?this.getAllTickets(this.events[0].id.toString()):this.getAllTickets("")},e=>{this.events=[]})}onChangeEvent(e){this.getAllTickets(e.toString())}onDownload(){this.orderService.getExportTicket(this.selectedEvent).subscribe(e=>{var n;const t=null===(n=this.events.find(e=>e.id==this.selectedEvent))||void 0===n?void 0:n.title;var i=new Blob([e],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"}),o=document.createElement("a");o.href=window.URL.createObjectURL(i),o.download=t+".xlsx",o.click()})}onDownloadOrder(){this.orderService.getExportOrder(this.selectedEvent).subscribe(e=>{var n;const t=null===(n=this.events.find(e=>e.id==this.selectedEvent))||void 0===n?void 0:n.title;var i=new Blob([e],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"}),o=document.createElement("a");o.href=window.URL.createObjectURL(i),o.download=t+"-orden.xlsx",o.click()})}}return e.\u0275fac=function(n){return new(n||e)(d.Y36(g.p),d.Y36(p.V),d.Y36(u.P))},e.\u0275cmp=d.Xpm({type:e,selectors:[["app-tickets"]],decls:10,vars:4,consts:[["nz-row","",1,"pt-2"],["nz-col","","nzSpan","24",1,"px-3","text-center","mb-1","mt-2"],["nz-row","",1,"pt-4"],["nz-col","","nzSpan","16","class","px-3 mb-3",4,"ngIf"],["nz-col","","nzSpan","8","class","px-3 mb-3 text-center",4,"ngIf"],["nz-col","","nzSpan","24","class","px-3",4,"ngIf"],[3,"loading"],["nz-col","","nzSpan","16",1,"px-3","mb-3"],["nzShowSearch","","nzAllowClear","","nzPlaceHolder","Seleccionar evento",1,"w-100",3,"ngModel","nzLoading","ngModelChange"],[3,"nzLabel","nzValue",4,"ngFor","ngForOf"],[3,"nzLabel","nzValue"],["nz-col","","nzSpan","8",1,"px-3","mb-3","text-center"],["nz-icon","","nzType","cloud-download","nzTheme","outline",2,"font-size","26px","color","#08c","margin-right","10px",3,"click"],["nz-icon","","nzType","file-markdown","nzTheme","outline",2,"font-size","26px","color","#08c",3,"click"],["nz-col","","nzSpan","24",1,"px-3"],["class","bg-white mb-3",4,"ngFor","ngForOf"],["class","d-flex  justify-content-center",4,"ngIf"],[1,"bg-white","mb-3"],[1,"lh-1","d-block",3,"routerLink"],["nz-row","",1,"align-items-center"],["nz-col","","nzSpan","8",1,"h-100"],["alt","",1,"img-fluid",3,"src"],["nz-col","","nzSpan","16",1,"py-3","px-3"],[1,"d-flex","flex-column","position-relative"],[1,"mb-2","lh-1"],["class","text-uppercase text-dark",4,"ngIf"],["class","position-absolute confirm-ticket",4,"ngIf"],[1,"text-uppercase","text-dark"],[1,"position-absolute","confirm-ticket"],[1,"d-flex","justify-content-center"]],template:function(e,n){1&e&&(d.TgZ(0,"div",0),d.TgZ(1,"div",1),d.TgZ(2,"h1"),d._uU(3,"Mis tickets"),d.qZA(),d.qZA(),d.TgZ(4,"div",2),d.YNc(5,z,3,3,"div",3),d.YNc(6,w,3,0,"div",4),d.YNc(7,E,3,2,"div",5),d.qZA(),d.TgZ(8,"div",1),d._UZ(9,"app-loading",6),d.qZA(),d.qZA()),2&e&&(d.xp6(5),d.Q6J("ngIf",n.user.isadmin),d.xp6(1),d.Q6J("ngIf",n.user.isadmin),d.xp6(1),d.Q6J("ngIf",!n.loading),d.xp6(2),d.Q6J("loading",n.loading))},directives:[f.SK,f.t3,i.O5,h.N,v.Vq,s.JJ,s.On,i.sg,v.Ip,x.w,m.Ls,l.yS],styles:[".confirm-ticket[_ngcontent-%COMP%]{border:2px solid #000;background-color:var(--tipme-yellow);padding:3px;bottom:-8px;right:0;font-size:10px}"]}),e})(),canActivate:[r.P]}];let N=(()=>{class e{}return e.\u0275fac=function(n){return new(n||e)},e.\u0275mod=d.oAB({type:e}),e.\u0275inj=d.cJS({imports:[[l.Bz.forChild(J)],l.Bz]}),e})(),U=(()=>{class e{}return e.\u0275fac=function(n){return new(n||e)},e.\u0275mod=d.oAB({type:e}),e.\u0275inj=d.cJS({imports:[[i.ez,o.m,c.JF,s.u5,s.UX,N]]}),e})()}}]);