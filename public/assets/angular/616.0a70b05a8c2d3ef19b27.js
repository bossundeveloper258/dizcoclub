(self.webpackChunkangular=self.webpackChunkangular||[]).push([[616],{2616:(n,e,t)=>{"use strict";t.r(e),t.d(e,{TicketsModule:()=>N});var i=t(8583),o=t(4466),c=t(1841),s=t(665),l=t(3423),r=t(7278),a=t(2340),g=t(7716),d=t(6854),p=t(2323),u=t(3117),f=t(9936),h=t(8424),v=t(3451),x=t(8429),Z=t(1425);function m(n,e){if(1&n&&g._UZ(0,"nz-option",10),2&n){const n=e.$implicit;g.Q6J("nzLabel",n.title)("nzValue",n.id)}}function z(n,e){if(1&n){const n=g.EpF();g.TgZ(0,"div",7),g.TgZ(1,"nz-select",8),g.NdJ("ngModelChange",function(e){return g.CHM(n),g.oxw().selectedEvent=e})("ngModelChange",function(e){return g.CHM(n),g.oxw().onChangeEvent(e)}),g.YNc(2,m,1,2,"nz-option",9),g.qZA(),g.qZA()}if(2&n){const n=g.oxw();g.xp6(1),g.Q6J("ngModel",n.selectedEvent)("nzLoading",n.loadingEvent),g.xp6(1),g.Q6J("ngForOf",n.events)}}function A(n,e){if(1&n){const n=g.EpF();g.TgZ(0,"div",11),g.TgZ(1,"i",12),g.NdJ("click",function(){return g.CHM(n),g.oxw().onDownload()}),g.qZA(),g.qZA()}}function T(n,e){if(1&n&&(g.TgZ(0,"p",26),g._uU(1),g.qZA()),2&n){const n=g.oxw().$implicit;g.xp6(1),g.AsE("",n.name," ",n.lastname,"")}}function k(n,e){if(1&n&&(g.TgZ(0,"p",26),g._uU(1),g.qZA()),2&n){const n=g.oxw().$implicit;g.xp6(1),g.hij("S/ ",n.price,"")}}function b(n,e){1&n&&(g.TgZ(0,"div",27),g._uU(1," CONFIRMADO "),g.qZA())}const w=function(n){return["/validate-token",n]};function S(n,e){if(1&n&&(g.TgZ(0,"section",16),g.TgZ(1,"a",17),g.TgZ(2,"div",18),g.TgZ(3,"div",19),g._UZ(4,"img",20),g.qZA(),g.TgZ(5,"div",21),g.TgZ(6,"div",22),g.TgZ(7,"p"),g._uU(8),g.qZA(),g.TgZ(9,"h5",23),g._uU(10),g.qZA(),g.YNc(11,T,2,2,"p",24),g.YNc(12,k,2,1,"p",24),g.YNc(13,b,2,0,"div",25),g.qZA(),g.qZA(),g.qZA(),g.qZA(),g.qZA()),2&n){const n=e.$implicit,t=g.oxw(2);g.xp6(1),g.Q6J("routerLink",g.VKq(7,w,n.id)),g.xp6(3),g.Q6J("src",t.routeStorage+"/"+n.event_path,g.LSH),g.xp6(4),g.hij("N\xb0 ",n.ticket,""),g.xp6(2),g.Oqu(n.event_title),g.xp6(1),g.Q6J("ngIf",t.user.isadmin),g.xp6(1),g.Q6J("ngIf",!t.user.isadmin),g.xp6(1),g.Q6J("ngIf",1==n.confirm)}}function q(n,e){1&n&&(g.TgZ(0,"section",28),g.TgZ(1,"h2"),g._uU(2,"No tiene Tickets"),g.qZA(),g.qZA())}function J(n,e){if(1&n&&(g.TgZ(0,"div",13),g.YNc(1,S,14,9,"section",14),g.YNc(2,q,3,0,"section",15),g.qZA()),2&n){const n=g.oxw();g.xp6(1),g.Q6J("ngForOf",n.tickets),g.xp6(1),g.Q6J("ngIf",0==n.tickets.length)}}const E=[{path:"",component:(()=>{class n{constructor(n,e,t){this.orderService=n,this.storageService=e,this.eventService=t,this.tickets=[],this.routeStorage=a.N.storageUrl,this.loading=!0,this.loadingEvent=!0,this.events=[],this.user=this.storageService.getUser()}ngOnInit(){this.getAllEvent()}onChangeTab(n){console.log(),this.getAllTickets(n.index)}getAllTickets(n){this.loading=!0,this.orderService.getTickets(n).subscribe(n=>{this.loading=!1,this.tickets=n},n=>{this.loading=!1})}getAllEvent(){this.loadingEvent=!0,this.eventService.getFindAll().subscribe(n=>{var e;this.events=n,this.loadingEvent=!1,this.selectedEvent=this.events[0].id,(null===(e=this.user)||void 0===e?void 0:e.isadmin)?this.getAllTickets(this.events[0].id.toString()):this.getAllTickets("")},n=>{this.events=[]})}onChangeEvent(n){this.getAllTickets(n.toString())}onDownload(){this.orderService.getExportTicket(this.selectedEvent).subscribe(n=>{var e;const t=null===(e=this.events.find(n=>n.id==this.selectedEvent))||void 0===e?void 0:e.title;var i=new Blob([n],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"}),o=document.createElement("a");o.href=window.URL.createObjectURL(i),o.download=t+".xlsx",o.click()})}}return n.\u0275fac=function(e){return new(e||n)(g.Y36(d.p),g.Y36(p.V),g.Y36(u.P))},n.\u0275cmp=g.Xpm({type:n,selectors:[["app-tickets"]],decls:10,vars:4,consts:[["nz-row","",1,"pt-2"],["nz-col","","nzSpan","24",1,"px-3","text-center","mb-1","mt-2"],["nz-row","",1,"pt-4"],["nz-col","","nzSpan","20","class","px-3 mb-3",4,"ngIf"],["nz-col","","nzSpan","4","class","px-3 mb-3",4,"ngIf"],["nz-col","","nzSpan","24","class","px-3",4,"ngIf"],[3,"loading"],["nz-col","","nzSpan","20",1,"px-3","mb-3"],["nzShowSearch","","nzAllowClear","","nzPlaceHolder","Seleccionar evento",1,"w-100",3,"ngModel","nzLoading","ngModelChange"],[3,"nzLabel","nzValue",4,"ngFor","ngForOf"],[3,"nzLabel","nzValue"],["nz-col","","nzSpan","4",1,"px-3","mb-3"],["nz-icon","","nzType","cloud-download","nzTheme","outline",2,"font-size","26px","color","#08c",3,"click"],["nz-col","","nzSpan","24",1,"px-3"],["class","bg-white mb-3",4,"ngFor","ngForOf"],["class","d-flex  justify-content-center",4,"ngIf"],[1,"bg-white","mb-3"],[1,"lh-1","d-block",3,"routerLink"],["nz-row","",1,"align-items-center"],["nz-col","","nzSpan","8",1,"h-100"],["alt","",1,"img-fluid",3,"src"],["nz-col","","nzSpan","16",1,"py-3","px-3"],[1,"d-flex","flex-column","position-relative"],[1,"mb-2","lh-1"],["class","text-uppercase text-dark",4,"ngIf"],["class","position-absolute confirm-ticket",4,"ngIf"],[1,"text-uppercase","text-dark"],[1,"position-absolute","confirm-ticket"],[1,"d-flex","justify-content-center"]],template:function(n,e){1&n&&(g.TgZ(0,"div",0),g.TgZ(1,"div",1),g.TgZ(2,"h1"),g._uU(3,"Mis tickets"),g.qZA(),g.qZA(),g.TgZ(4,"div",2),g.YNc(5,z,3,3,"div",3),g.YNc(6,A,2,0,"div",4),g.YNc(7,J,3,2,"div",5),g.qZA(),g.TgZ(8,"div",1),g._UZ(9,"app-loading",6),g.qZA(),g.qZA()),2&n&&(g.xp6(5),g.Q6J("ngIf",e.user.isadmin),g.xp6(1),g.Q6J("ngIf",e.user.isadmin),g.xp6(1),g.Q6J("ngIf",!e.loading),g.xp6(2),g.Q6J("loading",e.loading))},directives:[f.SK,f.t3,i.O5,h.N,v.Vq,s.JJ,s.On,i.sg,v.Ip,x.w,Z.Ls,l.yS],styles:[".confirm-ticket[_ngcontent-%COMP%]{border:2px solid #000;background-color:var(--tipme-yellow);padding:3px;bottom:-8px;right:0;font-size:10px}"]}),n})(),canActivate:[r.P]}];let I=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=g.oAB({type:n}),n.\u0275inj=g.cJS({imports:[[l.Bz.forChild(E)],l.Bz]}),n})(),N=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=g.oAB({type:n}),n.\u0275inj=g.cJS({imports:[[i.ez,o.m,c.JF,s.u5,s.UX,I]]}),n})()}}]);